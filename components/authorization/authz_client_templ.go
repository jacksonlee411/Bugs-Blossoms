// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.857
package authorization

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import "github.com/iota-uz/iota-sdk/pkg/composables"

func AuthzClient() templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		pageCtx := composables.UsePageCtx(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<div hidden data-authz-container data-toast-error-title=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var2 string
		templ_7745c5c3_Var2, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Toast.ErrorTitle"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 10, Col: 62}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var2))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "\" data-toast-default-error=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var3 string
		templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Toast.DefaultError"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 11, Col: 66}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "\" data-toast-stale-title=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var4 string
		templ_7745c5c3_Var4, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Toast.StaleRevisionTitle"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 12, Col: 70}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var4))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "\" data-toast-stale-message=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var5 string
		templ_7745c5c3_Var5, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Toast.StaleRevisionMessage"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 13, Col: 74}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var5))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "\" data-toast-applied-title=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var6 string
		templ_7745c5c3_Var6, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Toast.AppliedTitle"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 14, Col: 66}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var6))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "\" data-toast-applied-prefix=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var7 string
		templ_7745c5c3_Var7, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Toast.AppliedPrefix"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 15, Col: 68}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var7))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "\"></div>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Var8 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, "<script>\n\t\t\t(function () {\n\t\t\t\tif (window.authzClient) return;\n\n\t\t\t\tfunction toastLabels(container) {\n\t\t\t\t\tconst el = container || document.querySelector(\"[data-authz-container]\");\n\t\t\t\t\tconst ds = el?.dataset || {};\n\t\t\t\t\treturn {\n\t\t\t\t\t\terrorTitle: (ds.toastErrorTitle || \"\").trim(),\n\t\t\t\t\t\tdefaultError: (ds.toastDefaultError || \"\").trim(),\n\t\t\t\t\t\tstaleTitle: (ds.toastStaleTitle || \"\").trim(),\n\t\t\t\t\t\tstaleMessage: (ds.toastStaleMessage || \"\").trim(),\n\t\t\t\t\t\tappliedTitle: (ds.toastAppliedTitle || \"\").trim(),\n\t\t\t\t\t\tappliedPrefix: (ds.toastAppliedPrefix || \"\").trim(),\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tfunction parseDetail(detail) {\n\t\t\t\t\tlet data = detail || {};\n\t\t\t\t\tif (typeof data === \"string\") {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tdata = JSON.parse(data);\n\t\t\t\t\t\t} catch (_) {\n\t\t\t\t\t\t\tdata = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (data && data.value) return parseDetail(data.value);\n\t\t\t\t\treturn data || {};\n\t\t\t\t}\n\n\t\t\t\tfunction dispatchToast(variant, title, message) {\n\t\t\t\t\twindow.dispatchEvent(new CustomEvent(\"notify\", { detail: { variant, title, message } }));\n\t\t\t\t}\n\n\t\t\t\tfunction updateBaseRevision(newRev) {\n\t\t\t\t\tif (!newRev) return;\n\t\t\t\t\tdocument.querySelectorAll(\"[data-authz-container]\").forEach(function (container) {\n\t\t\t\t\t\tcontainer.dataset.baseRevision = newRev;\n\t\t\t\t\t\tcontainer.querySelectorAll(\"[data-authz-base-revision]\").forEach(function (el) {\n\t\t\t\t\t\t\tel.textContent = newRev;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tcontainer.querySelectorAll('input[name=\"base_revision\"]').forEach(function (el) {\n\t\t\t\t\t\t\tel.value = newRev;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction handleError(err) {\n\t\t\t\t\tconst detail = parseDetail(err) || {};\n\t\t\t\t\tconst code = detail.code || detail.Code || \"\";\n\t\t\t\t\tconst labels = toastLabels(null);\n\t\t\t\t\tconst message = detail.message || detail.Message || labels.defaultError;\n\t\t\t\t\tdispatchToast(\"error\", code || labels.errorTitle, message);\n\t\t\t\t\tconst baseRev = detail?.meta?.base_revision || detail?.meta?.baseRevision;\n\t\t\t\t\tif (baseRev) {\n\t\t\t\t\t\tupdateBaseRevision(baseRev);\n\t\t\t\t\t\tdispatchToast(\"warning\", labels.staleTitle, labels.staleMessage);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction handleApplied(event) {\n\t\t\t\t\tconst detail = parseDetail(event?.detail);\n\t\t\t\t\tif (!detail) return;\n\t\t\t\t\tconst rev = detail.revision || detail.Revision || \"\";\n\t\t\t\t\tconst added = detail.added ?? detail.Added ?? 0;\n\t\t\t\t\tconst removed = detail.removed ?? detail.Removed ?? 0;\n\t\t\t\t\tconst labels = toastLabels(null);\n\t\t\t\t\tconst prefix = labels.appliedPrefix || \"Applied\";\n\t\t\t\t\tconst title = labels.appliedTitle || \"Policies updated\";\n\t\t\t\t\tconst message = rev ? `${prefix} +${added}/-${removed} Â· ${rev}` : `${prefix} +${added}/-${removed}`;\n\t\t\t\t\tupdateBaseRevision(rev);\n\t\t\t\t\tdispatchToast(\"success\", title, message);\n\t\t\t\t}\n\n\t\t\t\tdocument.addEventListener(\"showErrorToast\", function (evt) {\n\t\t\t\t\thandleError(parseDetail(evt.detail));\n\t\t\t\t});\n\t\t\t\tdocument.addEventListener(\"authz:policies-applied\", handleApplied);\n\n\t\t\t\twindow.authzClient = { handleError, handleApplied };\n\t\t\t})();\n\t\t</script>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = authzClientScriptOnce.Once().Render(templ.WithChildren(ctx, templ_7745c5c3_Var8), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
