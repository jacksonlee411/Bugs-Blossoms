// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.857
package authorization

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import "github.com/iota-uz/iota-sdk/pkg/composables"

func AuthzClient() templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		pageCtx := composables.UsePageCtx(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<div hidden data-authz-container data-sla-unknown=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var2 string
		templ_7745c5c3_Var2, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.SLA.Unknown"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 10, Col: 51}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var2))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "\" data-sla-countdown-prefix=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var3 string
		templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.SLA.CountdownPrefix"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 11, Col: 68}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "\" data-status-unknown-label=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var4 string
		templ_7745c5c3_Var4, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Unknown"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 12, Col: 50}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var4))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "\" data-status-pending-review=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var5 string
		templ_7745c5c3_Var5, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Status.PendingReview"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 13, Col: 70}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var5))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "\" data-status-approved=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var6 string
		templ_7745c5c3_Var6, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Status.Approved"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 14, Col: 59}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var6))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "\" data-status-merged=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var7 string
		templ_7745c5c3_Var7, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Status.Merged"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 15, Col: 55}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var7))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "\" data-status-failed=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var8 string
		templ_7745c5c3_Var8, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Status.Failed"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 16, Col: 55}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var8))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, "\" data-status-rejected=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var9 string
		templ_7745c5c3_Var9, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Status.Rejected"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 17, Col: 59}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var9))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 9, "\" data-status-canceled=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var10 string
		templ_7745c5c3_Var10, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Status.Canceled"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 18, Col: 59}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var10))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 10, "\" data-status-draft=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var11 string
		templ_7745c5c3_Var11, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Status.Draft"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 19, Col: 53}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var11))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 11, "\" data-toast-error-title=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var12 string
		templ_7745c5c3_Var12, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Toast.ErrorTitle"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 20, Col: 62}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var12))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 12, "\" data-toast-default-error=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var13 string
		templ_7745c5c3_Var13, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Toast.DefaultError"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 21, Col: 66}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var13))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 13, "\" data-toast-stale-title=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var14 string
		templ_7745c5c3_Var14, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Toast.StaleRevisionTitle"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 22, Col: 70}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var14))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 14, "\" data-toast-stale-message=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var15 string
		templ_7745c5c3_Var15, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Toast.StaleRevisionMessage"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 23, Col: 74}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var15))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 15, "\" data-toast-submit-title=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var16 string
		templ_7745c5c3_Var16, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Unauthorized.SubmitSuccess"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 24, Col: 73}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var16))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 16, "\" data-toast-submitted-prefix=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var17 string
		templ_7745c5c3_Var17, templ_7745c5c3_Err = templ.JoinStringErrs(pageCtx.T("Authz.Toast.SubmittedPrefix"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `components/authorization/authz_client.templ`, Line: 25, Col: 72}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var17))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 17, "\"></div>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Var18 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 18, "<script>\n\t\t\t(function () {\n\t\t\t\tif (window.authzRequestWatcher) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst terminalStatuses = new Set([\"merged\", \"failed\", \"rejected\", \"canceled\"]);\n\t\t\t\tconst cache = new Map();\n\t\t\t\tconst watchers = new Map();\n\n\t\t\t\tfunction isTerminal(status) {\n\t\t\t\t\treturn terminalStatuses.has((status || \"\").toLowerCase());\n\t\t\t\t}\n\n\tfunction statusLabel(status, container) {\n\t\tconst labels = {\n\t\t\tpending_review: container?.dataset?.statusPendingReview,\n\t\t\tapproved: container?.dataset?.statusApproved,\n\t\t\tmerged: container?.dataset?.statusMerged,\n\t\t\tfailed: container?.dataset?.statusFailed,\n\t\t\trejected: container?.dataset?.statusRejected,\n\t\t\tcanceled: container?.dataset?.statusCanceled,\n\t\t\tdraft: container?.dataset?.statusDraft,\n\t\t};\n\t\tconst key = (status || \"\").toLowerCase();\n\t\treturn labels[key] || key || container?.dataset?.statusUnknownLabel || \"\";\n\t}\n\n\t\t\t\tfunction toastLabels(container) {\n\t\t\t\t\tconst el = container || document.querySelector(\"[data-authz-container]\");\n\t\t\t\t\tconst ds = el?.dataset || {};\n\t\t\t\t\treturn {\n\t\t\t\t\t\terrorTitle: (ds.toastErrorTitle || \"\").trim(),\n\t\t\t\t\t\tdefaultError: (ds.toastDefaultError || \"\").trim(),\n\t\t\t\t\t\tstaleTitle: (ds.toastStaleTitle || \"\").trim(),\n\t\t\t\t\t\tstaleMessage: (ds.toastStaleMessage || \"\").trim(),\n\t\t\t\t\t\tsubmitTitle: (ds.toastSubmitTitle || \"\").trim(),\n\t\t\t\t\t\tsubmittedPrefix: (ds.toastSubmittedPrefix || \"\").trim(),\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tfunction parseDetail(detail) {\n\t\t\t\t\tlet data = detail || {};\n\t\t\t\t\tif (typeof data === \"string\") {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tdata = JSON.parse(data);\n\t\t\t\t\t\t} catch (_) {\n\t\t\t\t\t\t\tdata = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (data && data.value) {\n\t\t\t\t\t\treturn parseDetail(data.value);\n\t\t\t\t\t}\n\t\t\t\t\treturn data || {};\n\t\t\t\t}\n\n\t\t\t\tfunction normalize(detail) {\n\t\t\t\t\tconst data = parseDetail(detail);\n\t\t\t\t\tif (!data) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\tconst id = data.id || data.ID || \"\";\n\t\t\t\t\tconst status = (data.status || data.Status || \"\").toLowerCase();\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: id,\n\t\t\t\t\t\tstatus: status,\n\t\t\t\t\t\tupdatedAt: data.updated_at || data.updatedAt || data.UpdatedAt,\n\t\t\t\t\t\testimatedSLA: data.estimated_sla_expires_at || data.EstimatedSLAExpiresAt,\n\t\t\t\t\t\tcanRetry: !!(data.can_retry_bot || data.CanRetryBot),\n\t\t\t\t\t\tretryToken: data.retry_token || data.RetryToken,\n\t\t\t\t\t\tviewUrl: data.view_url || data.ViewURL || (id ? \"/core/authz/requests/\" + id : \"\"),\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tfunction formatSLA(container, isoString) {\n\t\t\t\t\tconst unknown = (container?.dataset?.slaUnknown || \"\").trim();\n\t\t\t\t\tconst prefix = (container?.dataset?.slaCountdownPrefix || \"\").trim();\n\t\t\t\t\tif (!isoString) {\n\t\t\t\t\t\treturn unknown;\n\t\t\t\t\t}\n\t\t\t\t\tconst date = new Date(isoString);\n\t\t\t\t\tif (Number.isNaN(date.getTime())) {\n\t\t\t\t\t\treturn unknown;\n\t\t\t\t\t}\n\t\t\t\t\tconst diff = date.getTime() - Date.now();\n\t\t\t\t\tif (diff <= 0) {\n\t\t\t\t\t\treturn unknown;\n\t\t\t\t\t}\n\t\t\t\t\tconst mins = Math.floor(diff / 60000);\n\t\t\t\t\tconst secs = Math.floor((diff % 60000) / 1000);\n\t\t\t\t\tconst countdown = String(mins).padStart(2, \"0\") + \":\" + String(secs).padStart(2, \"0\");\n\t\t\t\t\treturn prefix ? prefix + \" \" + countdown : countdown;\n\t\t\t\t}\n\n\t\t\t\tfunction findContainer(id) {\n\t\t\t\t\tif (!id) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\treturn document.querySelector('[data-authz-container][data-request-id=\"' + id + '\"]');\n\t\t\t\t}\n\n\t\t\t\tfunction render(container, data) {\n\t\t\t\t\tif (!container) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst statusEl = container.querySelector(\"[data-authz-status]\");\n\t\t\t\t\tif (statusEl) {\n\t\t\tstatusEl.textContent = data\n\t\t\t\t? statusLabel(data.status, container) || container.dataset.statusUnknownLabel || \"\"\n\t\t\t\t: container.dataset.statusUnknownLabel || \"\";\n\t\t\t\t\t}\n\t\t\t\t\tconst slaEl = container.querySelector(\"[data-authz-sla]\");\n\t\t\t\t\tif (slaEl) {\n\t\t\t\t\t\tslaEl.textContent = data\n\t\t\t\t\t\t\t? formatSLA(container, data.estimatedSLA)\n\t\t\t\t\t\t\t: container.dataset.slaUnknown || \"\";\n\t\t\t\t\t}\n\t\t\t\t\tconst viewLink = container.querySelector(\"[data-authz-view]\");\n\t\t\t\t\tif (viewLink) {\n\t\t\t\t\t\tif (data && data.id) {\n\t\t\t\t\t\t\tviewLink.href = data.viewUrl || \"#\";\n\t\t\t\t\t\t\tviewLink.classList.remove(\"hidden\");\n\t\t\t\t\t\t\tviewLink.dataset.requestId = data.id;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tviewLink.classList.add(\"hidden\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconst retryBtn = container.querySelector(\"[data-authz-retry-bot]\");\n\t\t\t\t\tif (retryBtn) {\n\t\t\t\t\t\tif (data && data.status === \"failed\" && data.canRetry && data.retryToken) {\n\t\t\t\t\t\t\tretryBtn.dataset.requestId = data.id;\n\t\t\t\t\t\t\tretryBtn.dataset.retryToken = data.retryToken;\n\t\t\t\t\t\t\tretryBtn.classList.remove(\"hidden\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tretryBtn.classList.add(\"hidden\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconst idEl = container.querySelector(\"[data-authz-request-id]\");\n\t\t\t\t\tif (idEl && data && data.id) {\n\t\t\t\t\t\tidEl.textContent = data.id;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tasync function fetchRequest(id, opts) {\n\t\t\t\t\tconst now = Date.now();\n\t\t\t\t\tconst cached = cache.get(id);\n\t\t\t\t\tif (!opts?.force && cached && !isTerminal(cached.status) && now-cached.fetchedAt < 30000) {\n\t\t\t\t\t\treturn cached.data;\n\t\t\t\t\t}\n\t\t\t\t\tconst resp = await fetch(\"/core/api/authz/requests/\" + id);\n\t\t\t\t\tlet payload = null;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tpayload = await resp.json();\n\t\t\t\t\t} catch (_) {\n\t\t\t\t\t\tpayload = null;\n\t\t\t\t\t}\n\t\t\t\t\tif (!resp.ok) {\n\t\t\t\t\t\tconst labels = toastLabels(null);\n\t\t\t\t\t\tthrow payload || { code: resp.status, message: labels.defaultError };\n\t\t\t\t\t}\n\t\t\t\t\tconst data = normalize(payload);\n\t\t\t\t\tcache.set(id, { data, fetchedAt: Date.now(), status: data?.status || \"\" });\n\t\t\t\t\treturn data;\n\t\t\t\t}\n\n\t\t\t\tfunction dispatchToast(variant, title, message) {\n\t\t\t\t\twindow.dispatchEvent(\n\t\t\t\t\t\tnew CustomEvent(\"notify\", {\n\t\t\t\t\t\t\tdetail: { variant, title, message },\n\t\t\t\t\t\t}),\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tfunction handleError(err) {\n\t\t\t\t\tconst detail = normalize(err) || parseDetail(err) || {};\n\t\t\t\t\tconst code = detail.code || detail.Code || \"\";\n\t\t\t\t\tconst container = (detail.meta && detail.meta.request_id) ? findContainer(detail.meta.request_id) : null;\n\t\t\t\t\tconst labels = toastLabels(container);\n\t\t\t\t\tconst message = detail.message || detail.Message || labels.defaultError;\n\t\t\t\t\tdispatchToast(\"error\", code || labels.errorTitle, message);\n\t\t\t\t\tif (detail.meta && detail.meta.base_revision) {\n\t\t\t\t\t\tdispatchToast(\"warning\", labels.staleTitle, labels.staleMessage);\n\t\t\t\t\t}\n\t\t\t\t\tif (detail.meta && detail.meta.request_id) {\n\t\t\t\t\t\tconst retry = container?.querySelector(\"[data-authz-retry-bot]\");\n\t\t\t\t\t\tif (retry) {\n\t\t\t\t\t\t\tretry.classList.add(\"hidden\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction tick(state, force) {\n\t\t\t\t\tif (!state || !state.id || state.paused) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst now = Date.now();\n\t\t\t\t\tconst forceFetch = !!force || state.forceNext || (state.lastFetched > 0 && now - state.lastFetched > 120000);\n\t\t\t\t\tstate.forceNext = false;\n\t\t\t\t\tfetchRequest(state.id, { force: forceFetch })\n\t\t\t\t\t\t.then(function (data) {\n\t\t\t\t\t\t\tstate.lastFetched = Date.now();\n\t\t\t\t\t\t\trender(state.container, data);\n\t\t\t\t\t\t\tif (data && isTerminal(data.status) && state.timer) {\n\t\t\t\t\t\t\t\tclearInterval(state.timer);\n\t\t\t\t\t\t\t\tstate.timer = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(handleError);\n\t\t\t\t}\n\n\t\t\t\tfunction attach(container, id) {\n\t\t\t\t\tif (!container || !id) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcontainer.dataset.requestId = id;\n\t\t\t\t\tconst existing = watchers.get(container) || { lastFetched: 0, paused: false, forceNext: true };\n\t\t\t\t\texisting.id = id;\n\t\t\t\t\texisting.container = container;\n\t\t\t\t\texisting.forceNext = true;\n\t\t\t\t\tif (existing.timer) {\n\t\t\t\t\t\tclearInterval(existing.timer);\n\t\t\t\t\t}\n\t\t\t\t\texisting.timer = setInterval(function () {\n\t\t\t\t\t\ttick(existing, false);\n\t\t\t\t\t}, 15000);\n\t\t\t\t\twatchers.set(container, existing);\n\t\t\t\t\ttick(existing, true);\n\t\t\t\t}\n\n\t\t\t\tfunction handleUpdate(id, payload) {\n\t\t\t\t\tconst data = normalize(payload);\n\t\t\t\t\tif (data && data.id) {\n\t\t\t\t\t\tcache.set(data.id, { data, fetchedAt: Date.now(), status: data.status || \"\" });\n\t\t\t\t\t}\n\t\t\t\t\tconst container = findContainer(id);\n\t\t\t\t\tif (container) {\n\t\t\t\t\t\trender(container, data);\n\t\t\t\t\t\tattach(container, data?.id || id);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction handleCreated(event) {\n\t\t\t\t\tconst detail = normalize(event?.detail);\n\t\t\t\t\tif (!detail || !detail.id) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst labels = toastLabels(null);\n\t\t\t\t\tconst container = findContainer(detail.id) || document.querySelector(\"[data-authz-container]\");\n\t\t\t\t\tconst slaMsg = detail.estimatedSLA ? formatSLA(container, detail.estimatedSLA) : \"\";\n\t\t\t\t\tconst prefix = labels.submittedPrefix;\n\t\t\t\t\tconst message = slaMsg ? prefix + \" \" + detail.id + \" Â· \" + slaMsg : prefix + \" \" + detail.id;\n\t\t\t\t\tdispatchToast(\"success\", labels.submitTitle, message);\n\t\t\t\t\thandleUpdate(detail.id, detail);\n\t\t\t\t}\n\n\t\t\t\tfunction scan() {\n\t\t\t\t\tdocument.querySelectorAll(\"[data-authz-container]\").forEach(function (container) {\n\t\t\t\t\t\tconst id = container.dataset.requestId;\n\t\t\t\t\t\tif (id) {\n\t\t\t\t\t\t\tattach(container, id);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\twindow.addEventListener(\"focus\", function () {\n\t\t\t\t\twatchers.forEach(function (state) {\n\t\t\t\t\t\tstate.paused = false;\n\t\t\t\t\t\tstate.forceNext = true;\n\t\t\t\t\t\ttick(state, true);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\twindow.addEventListener(\"blur\", function () {\n\t\t\t\t\twatchers.forEach(function (state) {\n\t\t\t\t\t\tstate.paused = true;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tdocument.addEventListener(\"authz:request-created\", handleCreated);\n\t\t\t\tdocument.addEventListener(\"showErrorToast\", function (evt) {\n\t\t\t\t\thandleError(parseDetail(evt.detail));\n\t\t\t\t});\n\t\t\t\tdocument.addEventListener(\"htmx:load\", function () {\n\t\t\t\t\tscan();\n\t\t\t\t});\n\t\t\t\tscan();\n\n\t\t\t\twindow.authzRequestWatcher = {\n\t\t\t\t\tattach: attach,\n\t\t\t\t\thandleUpdate: handleUpdate,\n\t\t\t\t\tscan: scan,\n\t\t\t\t\thandleCreated: handleCreated,\n\t\t\t\t};\n\t\t\t})();\n\t\t</script> <script>\n\t\t\tif (!window.handleAuthzRequest) {\n\t\t\t\twindow.handleAuthzRequest = function (evt) {\n\t\t\t\t\tif (!evt || !evt.detail || !evt.detail.xhr) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar form = evt.target;\n\t\t\t\t\tvar xhr = evt.detail.xhr;\n\t\t\t\t\tvar container = form.closest(\"[data-authz-container]\");\n\t\t\t\t\tif (!container) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar baseRev = xhr.getResponseHeader(\"X-Authz-Base-Revision\");\n\t\t\t\t\tif (baseRev) {\n\t\t\t\t\t\tcontainer.dataset.baseRevision = baseRev;\n\t\t\t\t\t\tvar revInput = form.querySelector('input[name=\"base_revision\"]');\n\t\t\t\t\t\tif (revInput) {\n\t\t\t\t\t\t\trevInput.value = baseRev;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar revDisplay = container.querySelector(\"[data-authz-base-revision]\");\n\t\t\t\t\t\tif (revDisplay) {\n\t\t\t\t\t\t\trevDisplay.textContent = baseRev;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (xhr.status < 200 || xhr.status >= 300) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar payload = {};\n\t\t\t\t\ttry {\n\t\t\t\t\t\tpayload = JSON.parse(xhr.responseText || \"{}\");\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tpayload = {};\n\t\t\t\t\t}\n\t\t\t\t\tvar requestId = payload.id || payload.request_id || xhr.getResponseHeader(\"X-Request-ID\") || \"\";\n\t\t\t\t\tif (!requestId) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcontainer.dataset.requestId = requestId;\n\t\t\t\t\tvar requestIdEl = container.querySelector(\"[data-authz-request-id]\");\n\t\t\t\t\tif (requestIdEl) {\n\t\t\t\t\t\trequestIdEl.textContent = requestId;\n\t\t\t\t\t}\n\t\t\t\t\tif (window.authzRequestWatcher) {\n\t\t\t\t\t\twindow.authzRequestWatcher.handleUpdate(requestId, payload);\n\t\t\t\t\t\twindow.authzRequestWatcher.attach(container, requestId);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tdocument.addEventListener(\"click\", function (evt) {\n\t\t\t\t\tvar btn = evt.target.closest(\"[data-authz-copy-request-id]\");\n\t\t\t\t\tif (!btn) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar container = btn.closest(\"[data-authz-container]\");\n\t\t\t\t\tif (!container) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar requestIdEl = container.querySelector(\"[data-authz-request-id]\");\n\t\t\t\t\tif (!requestIdEl) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar text = (requestIdEl.textContent || \"\").trim();\n\t\t\t\t\tif (!text) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (navigator.clipboard && navigator.clipboard.writeText) {\n\t\t\t\t\t\tnavigator.clipboard.writeText(text);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tdocument.addEventListener(\"click\", function (evt) {\n\t\t\t\t\tvar retryBtn = evt.target.closest(\"[data-authz-retry-bot]\");\n\t\t\t\t\tif (!retryBtn) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar reqId = retryBtn.dataset.requestId;\n\t\t\t\t\tvar token = retryBtn.dataset.retryToken;\n\t\t\t\t\tif (!reqId || !token) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar container = retryBtn.closest(\"[data-authz-container]\");\n\t\t\t\t\tvar defaultErrorMsg = (container && container.dataset && container.dataset.toastDefaultError) || \"\";\n\t\t\t\t\tretryBtn.disabled = true;\n\t\t\t\t\tfetch(\"/core/api/authz/requests/\" + reqId + \"/trigger-bot?retry_token=\" + encodeURIComponent(token), {\n\t\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\t})\n\t\t\t\t\t\t.then(function (resp) {\n\t\t\t\t\t\t\treturn resp\n\t\t\t\t\t\t\t\t.json()\n\t\t\t\t\t\t\t\t.catch(function () {\n\t\t\t\t\t\t\t\t\treturn {};\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.then(function (body) {\n\t\t\t\t\t\t\t\t\treturn { ok: resp.ok, body: body };\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(function (result) {\n\t\t\t\t\t\t\tif (!result || !result.ok) {\n\t\t\t\t\t\t\t\tif (window.dispatchEvent) {\n\t\t\t\t\t\t\t\t\twindow.dispatchEvent(\n\t\t\t\t\t\t\t\t\t\tnew CustomEvent(\"showErrorToast\", {\n\t\t\t\t\t\t\t\t\t\t\tdetail: result?.body || { code: \"E_INTERNAL\", message: defaultErrorMsg, meta: { request_id: reqId } },\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (window.authzRequestWatcher) {\n\t\t\t\t\t\t\t\twindow.authzRequestWatcher.handleUpdate(reqId, result.body);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(function () {\n\t\t\t\t\t\t\tif (window.dispatchEvent) {\n\t\t\t\t\t\t\t\twindow.dispatchEvent(\n\t\t\t\t\t\t\t\t\tnew CustomEvent(\"showErrorToast\", {\n\t\t\t\t\t\t\t\t\t\tdetail: { code: \"E_INTERNAL\", message: defaultErrorMsg, meta: { request_id: reqId } },\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.finally(function () {\n\t\t\t\t\t\t\tretryBtn.disabled = false;\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t</script>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = authzClientScriptOnce.Once().Render(templ.WithChildren(ctx, templ_7745c5c3_Var18), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
